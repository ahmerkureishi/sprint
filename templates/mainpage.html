{% extends "base.html" %}

{% block title %}Sprint - Dashboard{% endblock %}

{% block script %}
$(document).ready(function(){
	$('#add_project_form').hide();
	$('#add_backlog_form').hide();
	$('#new_project').click(function(){
		$('#add_project_form').show();
		$(this).hide();
	});
	$('#cancel_add_project').click(function(){
		$('#add_project_form').hide();
		$('#new_project').show();
	});
	$('#new_backlog').click(function(){
		$('#add_backlog_form').show();
		$(this).hide();
	});
	$('#cancel_add_backlog').click(function(){
		$('#add_backlog_form').hide();
		$('#new_backlog').show();
	});
});
{% endblock %}

{% block content %}
<div class="span-16" id="main">
	<h1>Open Items for {{ user.first_name }} {{ user.last_name }}</h1>
	<hr>
	{% if not user_projects %} 
		<p>You have not been assigned any items.</p>
	{% else %}
		{% for project in user_projects %}
		<h2>{{ project.title }}</h2>
			{% for sprint in project.sprints %}
				<h3>{{ sprint.title }}</h3>
				{% for item in sprint.items %}
					<div>{{ item.title }} (<strong>{{ item.estimate }} hours</strong>) <a href='/item?id={{ item.key }}&next=/'>edit</a></div>
				{% endfor %}
			{% endfor %}
		{% endfor %}
	{% endif %}
</div>
<div class="span-8 last" id="nav">
	<h2>Projects</h2>
	{% for project in projects %}
		<p><a href="/project?id={{ project.key }}">{{ project.title }}</a></p>
	{% endfor %}
	<a href="#" class="action" id="new_project">Add a new project</a>
	<hr class="space">
	<form action="/project/new" method="post" id="add_project_form">
		<p><label>Enter a project title</label><br /> 
		<input type="text" class="text" name="title" size=40 maxsize=40>
		</p>
		<input type="submit" value="Create a New Project"> or <a href="#" class="action" id="cancel_add_project">Cancel</a>
	</form>
	<h2>Backlogs</h2>
	{% for backlog in backlogs %}
		<p><a href="/backlog?id={{ backlog.key }}">{{ backlog.title }}</a> : {{ backlog.owner.first_name }} {{ backlog.owner.last_name }}</p>
	{% endfor %}
	<a href="#" class="action" id="new_backlog">Add a new backlog</a>
	<hr class="space">
	<form action="/backlog/new" method="post" id="add_backlog_form">
		<p><label>Enter a backlog title</label><br />
		<input type="text"  class="text" name="title" size=40 maxsize=40></p>
		<p><label>Select the backlog owner</label><br />
		<select name="owner">
			{% for user in users %}
				<option value="{{ user.key }}">{{ user.first_name }} {{ user.last_name }}</option>
			{% endfor %}
		</select></p>
		<input type="submit" value="Create a New Backlog"> or <a href="#" class="action" id="cancel_add_backlog">Cancel</a>
	</form>
</div>
{% endblock %}
